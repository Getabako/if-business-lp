# お問い合わせフォーム実装ガイド

## 概要
Google Apps Script（GAS）を使用して、以下の機能を実装します：
- フォームデータをスプレッドシートに保存
- info@if-juku.net に通知メール送信
- 送信者に確認メール送信

## セットアップ手順

### 1. Google Apps Scriptの設定

1. **Google Apps Scriptを開く**
   - https://script.google.com/ にアクセス
   - 「新しいプロジェクト」をクリック

2. **スクリプトを作成**
   - プロジェクト名を「if-business-form-handler」に変更
   - `gas-form-handler.js` の内容をコピー&ペースト

3. **スプレッドシートとの連携**
   - スプレッドシートID: `1bRaJBgNaEyuF9QwFEwjCWS2lGdeDAltA9x21IrVuKAM`
   - シート名を確認（デフォルト：「シート1」）
   - 必要に応じてシート名を変更

### 2. Web アプリとしてデプロイ

1. **デプロイの設定**
   - 画面右上の「デプロイ」→「新しいデプロイ」
   - 種類：「ウェブアプリ」を選択
   - 実行ユーザー：「自分」
   - アクセスできるユーザー：「全員」

2. **権限の承認**
   - 「承認」をクリック
   - Gmail とスプレッドシートのアクセス権限を許可

3. **Web アプリURLを取得**
   - デプロイ完了後に表示されるURLをコピー
   - 例：`https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec`

### 3. フロントエンドの設定

1. **GAS URLの設定**
   ```typescript
   // ContactSection.tsx の45行目
   const GAS_URL = 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE'
   ```
   を実際のGAS URLに置き換え

2. **動作確認**
   - ローカルでテスト送信
   - スプレッドシートにデータが保存されることを確認
   - メール通知が届くことを確認

### 4. メール設定の調整

**管理者通知メール**
- 送信先: info@if-juku.net
- 件名: 【if(Business)】新規お問い合わせ - {お名前}様
- 内容: お客様情報 + お問い合わせ内容

**送信者確認メール**
- 送信元: GASを実行するGoogleアカウント
- 件名: 【if(Business)】お問い合わせを受け付けました
- 内容: 受付確認 + サービス案内 + 今後の流れ

## スプレッドシートの列構成

| A列 | B列 | C列 | D列 | E列 | F列 | G列 | H列 |
|-----|-----|-----|-----|-----|-----|-----|-----|
| 受信日時 | お名前 | メールアドレス | 会社名・団体名 | 電話番号 | ご興味のあるサービス | お問い合わせ内容 | ステータス |

## フォーム項目

1. **お名前** (必須)
2. **メールアドレス** (必須)
3. **会社名・団体名** (任意)
4. **お電話番号** (任意)
5. **ご興味のあるサービス** (任意)
   - AIパーソナル顧問プラン
   - AI人材育成プラン
   - AI開発支援プラン
   - ICT開発サービス
   - AIマーケティングサポート
   - AI講座プログラム
   - その他
6. **お問い合わせ内容** (必須)

## トラブルシューティング

### よくあるエラー

1. **CORS エラー**
   - GASで適切なヘッダーを設定済み
   - ブラウザの開発者ツールでエラー確認

2. **スプレッドシートアクセスエラー**
   - スプレッドシートIDが正しいか確認
   - GASアカウントにスプレッドシートの編集権限があるか確認

3. **メール送信エラー**
   - Gmailの送信制限を確認
   - メールアドレスの形式を確認

### テスト方法

1. **GAS内でテスト**
   ```javascript
   function testFormSubmission() {
     // テストデータでフォーム送信をシミュレート
   }
   ```

2. **フロントエンドでテスト**
   - 開発者ツールのNetworkタブでリクエスト確認
   - コンソールでエラーログ確認

## セキュリティ注意事項

- GAS URLは公開されるため、適切なバリデーションを実装
- スパム対策として、reCAPTCHAの追加を検討
- 個人情報の取り扱いに注意

## 本番稼働後の運用

- スプレッドシートのバックアップ定期取得
- メール送信ログの確認
- フォーム送信数の監視